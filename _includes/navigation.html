<!-- Main Navigation -->
<nav class="main-nav" role="navigation" aria-label="Main navigation">
  <div class="main-nav__container">
    <!-- Mobile menu button -->
    <button class="main-nav__toggle" 
            id="nav-toggle" 
            aria-expanded="false" 
            aria-controls="nav-menu"
            aria-label="Toggle navigation menu">
      <span class="main-nav__toggle-bar"></span>
      <span class="main-nav__toggle-bar"></span>
      <span class="main-nav__toggle-bar"></span>
    </button>

    <!-- Navigation menu -->
    <div class="main-nav__menu" id="nav-menu">
      <ul class="main-nav__list">
        {% for item in site.navigation %}
          {% assign current_path = page.url | remove: '.html' %}
          {% assign nav_path = item.url | remove: '.html' %}
          
          <li class="main-nav__item">
            <a href="{{ item.url | relative_url }}" 
               class="main-nav__link{% if current_path == nav_path or (nav_path == '/' and current_path == '/index') %} main-nav__link--active{% endif %}"
               {% if current_path == nav_path or (nav_path == '/' and current_path == '/index') %}aria-current="page"{% endif %}>
              {{ item.name }}
            </a>
          </li>
        {% endfor %}
      </ul>
      
      <!-- Social links in mobile menu -->
      <div class="main-nav__social">
        {% if site.author.github %}
          <a href="https://github.com/{{ site.author.github }}" 
             class="main-nav__social-link" 
             aria-label="GitHub Profile"
             title="GitHub">
            {% octicon mark-github height:20 class:"" fill:currentColor %}
          </a>
        {% endif %}
        
        {% if site.author.linkedin %}
          <a href="https://linkedin.com/in/{{ site.author.linkedin }}" 
             class="main-nav__social-link" 
             aria-label="LinkedIn Profile"
             title="LinkedIn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
            </svg>
          </a>
        {% endif %}
        
        {% if site.author.google_scholar %}
          <a href="https://scholar.google.com/citations?user={{ site.author.google_scholar }}" 
             class="main-nav__social-link" 
             aria-label="Google Scholar Profile"
             title="Google Scholar">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M5.242 13.769L0 9.5 12 0l12 9.5-5.242 4.269C17.548 11.249 14.978 9.5 12 9.5c-2.977 0-5.548 1.748-6.758 4.269zM12 10a7 7 0 1 0 0 14 7 7 0 0 0 0-14z"/>
            </svg>
          </a>
        {% endif %}
        
        {% if site.author.email %}
          <a href="mailto:{{ site.author.email }}" 
             class="main-nav__social-link" 
             aria-label="Email Contact"
             title="Email">
            {% octicon mail height:20 class:"" fill:currentColor %}
          </a>
        {% endif %}
      </div>
    </div>
  </div>
</nav>

<script>
  // Navigation functionality
  (function() {
    const navToggle = document.getElementById('nav-toggle');
    const navMenu = document.getElementById('nav-menu');
    
    if (navToggle && navMenu) {
      navToggle.addEventListener('click', function() {
        const isExpanded = navToggle.getAttribute('aria-expanded') === 'true';
        
        // Toggle aria-expanded
        navToggle.setAttribute('aria-expanded', !isExpanded);
        
        // Toggle menu visibility
        navMenu.classList.toggle('main-nav__menu--open');
        
        // Toggle body scroll lock on mobile
        document.body.classList.toggle('nav-open', !isExpanded);
      });
      
      // Close menu when clicking outside
      document.addEventListener('click', function(e) {
        if (!navToggle.contains(e.target) && !navMenu.contains(e.target)) {
          navToggle.setAttribute('aria-expanded', 'false');
          navMenu.classList.remove('main-nav__menu--open');
          document.body.classList.remove('nav-open');
        }
      });
      
      // Close menu on escape key
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && navMenu.classList.contains('main-nav__menu--open')) {
          navToggle.setAttribute('aria-expanded', 'false');
          navMenu.classList.remove('main-nav__menu--open');
          document.body.classList.remove('nav-open');
          navToggle.focus();
        }
      });
      
      // Handle window resize
      window.addEventListener('resize', function() {
        if (window.innerWidth >= 768) {
          navToggle.setAttribute('aria-expanded', 'false');
          navMenu.classList.remove('main-nav__menu--open');
          document.body.classList.remove('nav-open');
        }
      });
    }
  })();
</script>
